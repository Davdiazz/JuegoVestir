<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de la Serpiente</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            touch-action: none;
        }

        #gameContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        #gameInfo {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 30px;
            font-size: 20px;
            font-weight: bold;
        }

        #score {
            color: #667eea;
        }

        #highScore {
            color: #764ba2;
        }

        canvas {
            background: linear-gradient(135deg, #a8e063 0%, #56ab2f 100%);
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            max-width: 90vw;
            max-height: 60vh;
        }

        #controls {
            display: none;
            grid-template-areas:
                ". up ."
                "left down right";
            gap: 10px;
            margin-top: 20px;
        }

        .control-btn {
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 15px;
            font-size: 30px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:active {
            transform: scale(0.95);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        #upBtn { grid-area: up; }
        #leftBtn { grid-area: left; }
        #downBtn { grid-area: down; }
        #rightBtn { grid-area: right; }

        #gameOverScreen, #victoryScreen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
        }

        .modal h1 {
            font-size: 48px;
            margin-bottom: 20px;
            color: #667eea;
        }

        .modal p {
            font-size: 24px;
            margin-bottom: 30px;
            color: #333;
        }

        .modal button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 20px;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }

        .modal button:hover {
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            #controls {
                display: grid;
            }

            canvas {
                max-width: 95vw;
                max-height: 50vh;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="gameInfo">
            <div id="score">Puntuaci√≥n: 0</div>
            <div id="highScore">R√©cord: 0</div>
        </div>
        <canvas id="gameCanvas" width="600" height="400"></canvas>
        <div id="controls">
            <button class="control-btn" id="upBtn">‚Üë</button>
            <button class="control-btn" id="leftBtn">‚Üê</button>
            <button class="control-btn" id="downBtn">‚Üì</button>
            <button class="control-btn" id="rightBtn">‚Üí</button>
        </div>
    </div>

    <div id="gameOverScreen">
        <div class="modal">
            <h1>¬°Juego Terminado! üíÄ</h1>
            <p id="finalScore"></p>
            <button onclick="restartGame()">Jugar de Nuevo</button>
        </div>
    </div>

    <div id="victoryScreen">
        <div class="modal">
            <h1>¬°Victoria! üéâ</h1>
            <p>¬°Has llenado toda la pantalla!<br>¬°Eres un maestro de la serpiente!</p>
            <button onclick="restartGame()">Jugar de Nuevo</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('highScore');
        
        const gridSize = 20;
        const tileCountX = canvas.width / gridSize;
        const tileCountY = canvas.height / gridSize;
        
        let snake = [{x: 10, y: 10}];
        let dx = 0;
        let dy = 0;
        let food = {x: 15, y: 10};
        let score = 0;
        let highScore = 0;
        let gameSpeed = 100;
        let gameLoop;
        let gameRunning = false;

        const fruits = ['üçé', 'üçä', 'üçã', 'üçå', 'üçâ', 'üçá', 'üçì'];
        let currentFruit = fruits[0];

        // Controles de teclado
        document.addEventListener('keydown', changeDirection);

        // Controles t√°ctiles
        document.getElementById('upBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            setDirection(0, -1);
        });
        document.getElementById('downBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            setDirection(0, 1);
        });
        document.getElementById('leftBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            setDirection(-1, 0);
        });
        document.getElementById('rightBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            setDirection(1, 0);
        });

        // Tambi√©n con click para probar en escritorio
        document.getElementById('upBtn').addEventListener('click', () => setDirection(0, -1));
        document.getElementById('downBtn').addEventListener('click', () => setDirection(0, 1));
        document.getElementById('leftBtn').addEventListener('click', () => setDirection(-1, 0));
        document.getElementById('rightBtn').addEventListener('click', () => setDirection(1, 0));

        function setDirection(newDx, newDy) {
            if (!gameRunning) {
                startGame();
            }

            const goingUp = dy === -1;
            const goingDown = dy === 1;
            const goingRight = dx === 1;
            const goingLeft = dx === -1;

            if (newDx === -1 && !goingRight) {
                dx = -1; dy = 0;
            } else if (newDx === 1 && !goingLeft) {
                dx = 1; dy = 0;
            } else if (newDy === -1 && !goingDown) {
                dx = 0; dy = -1;
            } else if (newDy === 1 && !goingUp) {
                dx = 0; dy = 1;
            }
        }

        function changeDirection(e) {
            const LEFT = 37, UP = 38, RIGHT = 39, DOWN = 40;
            const A = 65, W = 87, D = 68, S = 83;
            
            if (!gameRunning && (e.keyCode === UP || e.keyCode === DOWN || 
                e.keyCode === LEFT || e.keyCode === RIGHT ||
                e.keyCode === W || e.keyCode === S || 
                e.keyCode === A || e.keyCode === D)) {
                startGame();
            }

            const keyPressed = e.keyCode;

            if (keyPressed === LEFT || keyPressed === A) {
                setDirection(-1, 0);
            } else if (keyPressed === UP || keyPressed === W) {
                setDirection(0, -1);
            } else if (keyPressed === RIGHT || keyPressed === D) {
                setDirection(1, 0);
            } else if (keyPressed === DOWN || keyPressed === S) {
                setDirection(0, 1);
            }
        }

        function startGame() {
            if (gameRunning) return;
            gameRunning = true;
            if (dx === 0 && dy === 0) {
                dx = 1;
                dy = 0;
            }
            gameLoop = setInterval(update, gameSpeed);
        }

        function update() {
            moveSnake();
            if (checkCollision()) {
                endGame();
                return;
            }
            if (checkFoodCollision()) {
                score++;
                scoreElement.textContent = 'Puntuaci√≥n: ' + score;
                if (score > highScore) {
                    highScore = score;
                    highScoreElement.textContent = 'R√©cord: ' + highScore;
                }
                generateFood();
                currentFruit = fruits[Math.floor(Math.random() * fruits.length)];
                
                // Aumentar velocidad gradualmente
                if (score % 5 === 0 && gameSpeed > 50) {
                    clearInterval(gameLoop);
                    gameSpeed -= 5;
                    gameLoop = setInterval(update, gameSpeed);
                }
            } else {
                snake.pop();
            }
            
            // Verificar victoria (90% del tablero lleno)
            if (snake.length >= (tileCountX * tileCountY * 0.9)) {
                victory();
                return;
            }
            
            draw();
        }

        function moveSnake() {
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            snake.unshift(head);
        }

        function checkCollision() {
            const head = snake[0];
            
            // Colisi√≥n con paredes
            if (head.x < 0 || head.x >= tileCountX || head.y < 0 || head.y >= tileCountY) {
                return true;
            }
            
            // Colisi√≥n con el cuerpo
            for (let i = 1; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    return true;
                }
            }
            
            return false;
        }

        function checkFoodCollision() {
            return snake[0].x === food.x && snake[0].y === food.y;
        }

        function generateFood() {
            let validPosition = false;
            while (!validPosition) {
                food.x = Math.floor(Math.random() * tileCountX);
                food.y = Math.floor(Math.random() * tileCountY);
                
                validPosition = true;
                for (let segment of snake) {
                    if (segment.x === food.x && segment.y === food.y) {
                        validPosition = false;
                        break;
                    }
                }
            }
        }

        function draw() {
            // Fondo con patr√≥n
            ctx.fillStyle = '#a8e063';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = 'rgba(86, 171, 47, 0.1)';
            for (let i = 0; i < canvas.width; i += gridSize) {
                for (let j = 0; j < canvas.height; j += gridSize) {
                    if ((i / gridSize + j / gridSize) % 2 === 0) {
                        ctx.fillRect(i, j, gridSize, gridSize);
                    }
                }
            }
            
            // Dibujar serpiente
            snake.forEach((segment, index) => {
                if (index === 0) {
                    // Cabeza
                    ctx.fillStyle = '#4a5fd6';
                    ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
                    ctx.strokeStyle = '#3a4fb6';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
                    
                    // Ojos
                    ctx.fillStyle = 'white';
                    ctx.beginPath();
                    ctx.arc(segment.x * gridSize + 6, segment.y * gridSize + 7, 3, 0, Math.PI * 2);
                    ctx.arc(segment.x * gridSize + 14, segment.y * gridSize + 7, 3, 0, Math.PI * 2);
                    ctx.fill();
                    
                    ctx.fillStyle = 'black';
                    ctx.beginPath();
                    ctx.arc(segment.x * gridSize + 6, segment.y * gridSize + 7, 1.5, 0, Math.PI * 2);
                    ctx.arc(segment.x * gridSize + 14, segment.y * gridSize + 7, 1.5, 0, Math.PI * 2);
                    ctx.fill();
                } else {
                    // Cuerpo
                    const gradient = ctx.createLinearGradient(
                        segment.x * gridSize, segment.y * gridSize,
                        segment.x * gridSize + gridSize, segment.y * gridSize + gridSize
                    );
                    gradient.addColorStop(0, '#5a6fd8');
                    gradient.addColorStop(1, '#6a7fe8');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(segment.x * gridSize + 1, segment.y * gridSize + 1, gridSize - 2, gridSize - 2);
                }
            });
            
            // Dibujar comida (emoji de fruta)
            ctx.font = '18px Arial';
            ctx.fillText(currentFruit, food.x * gridSize + 1, food.y * gridSize + 16);
        }

        function endGame() {
            clearInterval(gameLoop);
            gameRunning = false;
            document.getElementById('finalScore').textContent = 'Puntuaci√≥n final: ' + score;
            document.getElementById('gameOverScreen').style.display = 'flex';
        }

        function victory() {
            clearInterval(gameLoop);
            gameRunning = false;
            document.getElementById('victoryScreen').style.display = 'flex';
        }

        function restartGame() {
            snake = [{x: 10, y: 10}];
            dx = 0;
            dy = 0;
            score = 0;
            gameSpeed = 100;
            scoreElement.textContent = 'Puntuaci√≥n: 0';
            generateFood();
            currentFruit = fruits[0];
            document.getElementById('gameOverScreen').style.display = 'none';
            document.getElementById('victoryScreen').style.display = 'none';
            gameRunning = false;
            draw();
        }

        // Inicializar el juego
        generateFood();
        draw();
    </script>
</body>
</html>